/* SPCalendarPro v1.3.3 | (c) samperrow https://sphacks.io/sp-calendar-pro */ 
!function(e,t){e.spcalpro=function(){"use strict";n.prototype.isSameDate=function(e,t){return this.data.filter(function(r){return r.EventDate.split(" ")[0]===e&&r.EndDate.split(" ")[0]===t})},n.prototype.matchDateTimes=function(e,t){return this.data.filter(function(r){return r.EventDate<=e&&r.EndDate>=t})},n.prototype.isTimeConflict=function(e,t){return this.data.filter(function(r){var n=r.EventDate,a=r.EndDate;return e<=n&&t>=a||n<e&&a>e||n<t&&a>t||e<n&&t>a})};var e=function(e,t){var r='<soap:Envelope xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:soap="http://schemas.xmlsoap.org/soap/envelope/"><soap:Body><GetListItems xmlns="http://schemas.microsoft.com/sharepoint/soap/"><listName>'+e.listName+"</listName>",n="</GetListItems></soap:Body></soap:Envelope>",a='<Where><DateRangesOverlap><FieldRef Name="EventDate"/><FieldRef Name="EndDate"/><FieldRef Name="RecurrenceID"/><Value Type="DateTime"><Year/></Value></DateRangesOverlap></Where>',o='<OrderBy><FieldRef Name="EventDate"/></OrderBy></Query></query><queryOptions><QueryOptions><RecurrencePatternXMLVersion>v3</RecurrencePatternXMLVersion><ExpandRecurrence>TRUE</ExpandRecurrence><RecurrenceOrderBy>TRUE</RecurrenceOrderBy><ViewAttributes Scope="RecursiveAll"/></QueryOptions></queryOptions>';return function(){var s="<query><Query>",i="</Query></query>";e.camlQuery&&(s=e.camlQuery);e.fields&&(i+=function(){for(var r="calendar"===t?'<FieldRef Name="fRecurrence"/>':"",n=0;n<e.fields.length;n++)"string"==typeof e.fields[n]&&(r+='<FieldRef Name="'+e.fields[n]+'"/>');return r.length>0?"<viewFields><ViewFields>"+r+"</ViewFields></viewFields>":""}());e.where&&(s+=(l=e.where,u=l.split(" ")[0],c=l.split(" ")[1],p=l.split(c+" ")[1],m={"=":"Eq",">":"Gt","<":"Lt",">=":"Geq","<=":"Leq","!=":"Neq"},"<Where><"+m[c]+'><FieldRef Name="'+u+'"/><Value Type="Text">'+p+"</Value></"+m[c]+"></Where>"));var l,u,c,p,m;"list"===t?s+=i:"calendar"===t&&(s+=a+o);return r+s+n}()},t=function(e,t){var r,n;function a(t){4==t.readyState&&200==t.status?(!function(t){if(t.responseXML)return e.data=o(t.responseXML.getElementsByTagName("*"));if(!t.responseXML&&t.responseText){var r=(n=t.responseText.replace(/&#22;|&#0;/g,""),window.ActiveXObject?new ActiveXObject("Microsoft.XMLDOM").loadXML(n):(new DOMParser).parseFromString(n,"application/xml"));return e.data=o(r.getElementsByTagName("*"))}var n}(t),s()):500==t.status&&(!function(t){e.error={errorCode:/<errorcode xmlns="http:\/\/schemas.microsoft.com\/sharepoint\/soap\/">/.test(t.responseText)?t.responseText.split('<errorcode xmlns="http://schemas.microsoft.com/sharepoint/soap/">')[1].split("</errorcode>")[0]:"",errorString:/<errorstring xmlns="http:\/\/schemas.microsoft.com\/sharepoint\/soap\/">/.test(t.responseText)?t.responseText.split('<errorstring xmlns="http://schemas.microsoft.com/sharepoint/soap/">')[1].split("</errorstring>")[0]:"",faultString:/<faultstring>/.test(t.responseText)?t.responseText.split("<faultstring>")[1].split("</faultstring>")[0]:""}}(t),s())}function o(e){for(var t=[],r=0;r<e.length;r++){var n={},a=e[r].attributes;if("z:row"===e[r].nodeName){for(var o=0;o<a.length;o++){var s=a[o].name.split("ows_")[1];n[s]=a[o].value}t.push(n)}}return t}function s(){return t.callback?t.callback(e.data,e):e.userCallback?e.userCallback(e.data,e):e}return r=e.CamlQuery,(n=new XMLHttpRequest).open("POST",e.userEnvData,e.async),n.setRequestHeader("X-Requested-With","XMLHttpRequest"),n.setRequestHeader("Content-Type",'text/xml;charset="utf-8"'),n.send(r),!0===e.async?n[n.onload?"onload":"onreadystatechange"]=function(){return a(n)}:a(n),e.data};function r(e){var t=document.querySelectorAll('input[id$="DateTimeField_DateTimeFieldDate"]')[e].parentNode.parentNode,r=t.getElementsByClassName("ms-dttimeinput")[0],n=r.getElementsByTagName("select");return{date:t.getElementsByTagName("td")[0].getElementsByTagName("input")[0],hours:n?n[0]:null,min:n?n[1]:null}}String.prototype.formatInputToHours=function(){var e=this.split(" "),t=Number(e[0]);return"PM"===e[1]&&t<12?t+=12:t<10?"0"+t.toString():t},String.prototype.formatHoursToStr=function(){var e=this.split(":"),t=Number(e[0]),r="";return t>12?(t-=12,r=" PM"):r=" AM",{hours:t.toString()+r,min:e[1]}},String.prototype.removeLeadingZero=function(){return 0===this.indexOf("0")?this.charAt(1):this.valueOf()};function n(r,n){var a,o,s=Array.prototype.slice.call(arguments);for(var i in s[0])this[i]=s[0][i];return this.userEnvData=(a=r.sourceSite,o=_spPageContextInfo.webUIVersion,"string"==typeof a&&a.length>0?a+"/_vti_bin/Lists.asmx":15===o?_spPageContextInfo.webAbsoluteUrl+"/_vti_bin/Lists.asmx":document.location.protocol+"//"+document.location.host+_spPageContextInfo.webServerRelativeUrl+"/_vti_bin/Lists.asmx"),this.async||(this.async=!0),Array.prototype.filter||(Array.prototype.filter=function(e){if(null==this)throw new TypeError;var t=Object(this),r=t.length>>>0;if("function"!=typeof e)throw new TypeError;for(var n=[],a=arguments[1],o=0;o<r;o++)if(o in t){var s=t[o];e.call(a,s,o,t)&&n.push(s)}return n}),this.ready=function(e){return this.userCallback=e},this.callback=function(){return r.callback?r.callback(this):null},"string"==typeof r.listName?(this.CamlQuery=e(r,n),this.data=t(this,r)):console.error("You must specify a list name."),this}return{convertDateToFormFriendlyDateObj:function(e){return function(e){e=e.replace(/-/g,"/");var t=new Date(e).toTimeString().split(" ")[0].formatHoursToStr();return{date:(r=e.split(" ")[0],n=r.split("/"),n[1].removeLeadingZero()+"/"+n[2].removeLeadingZero()+"/"+n[0]),hours:t.hours,min:t.min};var r,n}(e)},getCalendarEvents:function(e){return new n(e,"calendar")},getDateFromFormFieldRow:function(e){return t=r(e||0),n=t.date.value.split("/").map(function(e){return 1===e.length?"0"+e:e}),a=n[2]+"/"+n[0]+"/"+n[1],o=t.hours.value.formatInputToHours()+":"+t.min.value+":00",{dateStr:s=a+" "+o,dateObj:new Date(s)};var t,n,a,o,s},getListItems:function(e){return new n(e,"list")},getValueFromDropDown:function(e){var t=document.querySelectorAll('select[title^="'+e+'"]')[0];return t.disabled?t.parentNode.parentNode.nextSibling.nextSibling.getElementsByTagName("input")[0].value:t.value},disableDragAndDrop:function(){ExecuteOrDelayUntilScriptLoaded(function(){var e=SP.UI.ApplicationPages.CalendarContainerFactory.create;SP.UI.ApplicationPages.CalendarContainerFactory.create=function(t,r,n,a,o){if(r.dataSources&&r.dataSources instanceof Array&&r.dataSources.length>0)for(var s=0;s<r.dataSources.length;s++)r.dataSources[s].disableDrag=!0;e(t,r,n,a,o)}},"SP.UI.ApplicationPages.Calendar.js")},getElemsFromFormDTRow:function(e){return r(e)}}}()}(this);