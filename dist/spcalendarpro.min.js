/* SPCalendarPro v1.3.0 | (c) samperrow https://sharepointhacks.com/sp-calendar-pro */ 
!function(e,t){e.spcalpro=function(){"use strict";function e(e,t){return{begin:{beginDateTime:e,beginDate:e.split(" ")[0],beginTime:e.split(" ")[1]},end:{endDateTime:t,endDate:t.split(" ")[0],endTime:t.split(" ")[1]}}}a.prototype.isSameDate=function(){var e=this.userDateTimes.begin.beginDate,t=this.userDateTimes.end.endDate;return this.data.filter(function(r){return r.EventDate.toDateString()===e&&r.EndDate.toDateString()===t})},a.prototype.matchDateTimes=function(){var e=this.userDateTimes.begin.beginDateTime,t=this.userDateTimes.end.endDateTime;return this.data.filter(function(r){return r.EventDate<=e&&r.EndDate>=t})},a.prototype.isTimeConflict=function(){var e=this.userDateTimes.begin.beginDateTime,t=this.userDateTimes.end.endDateTime;return this.data.filter(function(r){var n=r.EventDate,a=r.EndDate;return e<=n&&t>=a||n<e&&a>e||n<t&&a>t||e<n&&t>a})};var t=function(e,t,r){var n='<soap:Envelope xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:soap="http://schemas.xmlsoap.org/soap/envelope/"><soap:Body><GetListItems xmlns="http://schemas.microsoft.com/sharepoint/soap/"><listName>'+t.listName+"</listName>",a="</GetListItems></soap:Body></soap:Envelope>",s='<Where><DateRangesOverlap><FieldRef Name="EventDate"/><FieldRef Name="EndDate"/><FieldRef Name="RecurrenceID"/><Value Type="DateTime"><Year/></Value></DateRangesOverlap></Where>',i='<OrderBy><FieldRef Name="EventDate"/></OrderBy></Query></query><queryOptions><QueryOptions><RecurrencePatternXMLVersion>v3</RecurrencePatternXMLVersion><ExpandRecurrence>TRUE</ExpandRecurrence><RecurrenceOrderBy>TRUE</RecurrenceOrderBy><ViewAttributes Scope="RecursiveAll"/></QueryOptions></queryOptions>';return function(){var e="<query><Query>",o="</Query></query>";t.customCamlQuery&&(e=t.customCamlQuery);t.fields&&(o+=function(){for(var e="calendar"===r?'<FieldRef Name="fRecurrence"/>':"",n=0;n<t.fields.length;n++)"string"==typeof t.fields[n]&&(e+='<FieldRef Name="'+t.fields[n]+'"/>');return e.length>0?"<viewFields><ViewFields>"+e+"</ViewFields></viewFields>":""}());t.where&&(e+=(l=t.where,u=l.split(" ")[0],c=l.split(" ")[1],m=l.split(c+" ")[1],p={"=":"Eq",">":"Gt","<":"Lt",">=":"Geq","<=":"Leq","!=":"Neq"},"<Where><"+p[c]+'><FieldRef Name="'+u+'"/><Value Type="Text">'+m+"</Value></"+p[c]+"></Where>"));var l,u,c,m,p;"list"===r?e+=o:"calendar"===r&&(e+=s+i);return n+e+a}()},r=function(e,t){var r,n,a=void 0===t.async||t.async;function s(t){4==t.readyState&&200==t.status?(!function(t){if(t.responseXML)return e.data=i(t.responseXML.getElementsByTagName("*"));if(!t.responseXML&&t.responseText){var r=(n=t.responseText.replace(/&#22;|&#0;/g,""),window.ActiveXObject?new ActiveXObject("Microsoft.XMLDOM").loadXML(n):(new DOMParser).parseFromString(n,"application/xml"));return e.data=i(r.getElementsByTagName("*"))}var n}(t),o()):500==t.status&&(!function(t){e.error={errorCode:/<errorcode xmlns="http:\/\/schemas.microsoft.com\/sharepoint\/soap\/">/.test(t.responseText)?t.responseText.split('<errorcode xmlns="http://schemas.microsoft.com/sharepoint/soap/">')[1].split("</errorcode>")[0]:"",errorString:/<errorstring xmlns="http:\/\/schemas.microsoft.com\/sharepoint\/soap\/">/.test(t.responseText)?t.responseText.split('<errorstring xmlns="http://schemas.microsoft.com/sharepoint/soap/">')[1].split("</errorstring>")[0]:"",faultString:/<faultstring>/.test(t.responseText)?t.responseText.split("<faultstring>")[1].split("</faultstring>")[0]:""},console.error(e.error),e.error}(t),o())}function i(e){for(var t=[],r=0;r<e.length;r++){var n={},a=e[r].attributes;if("z:row"===e[r].nodeName){for(var s=0;s<a.length;s++){var i=a[s].name.split("ows_")[1];n[i]=a[s].value}t.push(n)}}return t}function o(){return t.callback?t.callback(e.data,e):e.userCallback?e.userCallback(e.data,e):e}return r=e.CamlQuery,(n=new XMLHttpRequest).open("POST",e.userEnvData,a),n.setRequestHeader("X-Requested-With","XMLHttpRequest"),n.setRequestHeader("Content-Type",'text/xml;charset="utf-8"'),n.send(r),!0===a?n[n.onload?"onload":"onreadystatechange"]=function(){return s(n)}:s(n),e.data};String.prototype.formatInputToHours=function(){var e=this.split(" "),t=Number(e[0]);return"PM"===e[1]&&t<12?t+=12:t};function n(e){return e?"function"==typeof e.getMonth?e:new Date(e):null}function a(e,a){var s,i;return this.listName=e.listName?e.listName:null,this.getEventsAfterDate=n(e.getEventsAfterDate),this.getEventsBeforeDate=n(e.getEventsBeforeDate),this.fields=e.fields?e.fields:null,this.userDateTimes=e.userDateTimes?e.userDateTimes:null,this.customCamlQuery=e.customCamlQuery?e.customCamlQuery:null,this.where=e.where?e.where:null,this.userEnvData=(s=e.sourceSite,i=_spPageContextInfo.webUIVersion,"string"==typeof s&&s.length>0?s+"/_vti_bin/Lists.asmx":15===i?_spPageContextInfo.webAbsoluteUrl+"/_vti_bin/Lists.asmx":document.location.protocol+"//"+document.location.host+_spPageContextInfo.webServerRelativeUrl+"/_vti_bin/Lists.asmx"),Array.prototype.filter||(Array.prototype.filter=function(e){if(null==this)throw new TypeError;var t=Object(this),r=t.length>>>0;if("function"!=typeof e)throw new TypeError;for(var n=[],a=arguments[1],s=0;s<r;s++)if(s in t){var i=t[s];e.call(a,i,s,t)&&n.push(i)}return n}),this.ready=function(e){this.userCallback=e},this.callback=function(){return e.callback?e.callback(this):null},"string"==typeof e.listName?(this.CamlQuery=t(this,e,a),this.data=r(this,e)):console.error("You must specify a list name."),this}return{getCalendarEvents:function(e){return new a(e,"calendar")},getListItems:function(e){return new a(e,"list")},getDateTimesFromForm:function(t,r){var n=function(e,t){function r(e){var t=document.querySelectorAll('input[id$="DateTimeField_DateTimeFieldDate"]')[e].parentNode.parentNode,r=t.getElementsByClassName("ms-dttimeinput")[0];if(r)var n=r.getElementsByTagName("select")[0].value,a=r.getElementsByTagName("select")[1].value;var s=t.getElementsByTagName("td")[0].getElementsByTagName("input")[0].value.split("/");1===s[0].length&&(s[0]="0"+s[0]);var i=s[2]+"-"+s[0]+"-"+s[1];return{date:i.toString(),time:function(){return n&&a?n.formatInputToHours()+":"+a+":00":""}}}t=t||1;var n=r(e=e||0),a=r(t);return{userBeginDT:n.date+" "+n.time(),userEndDT:a.date+" "+a.time()}}(t,r);return e(n.userBeginDT,n.userEndDT)},userDates:function(t,r){return e(t,r)},disableDragAndDrop:function(){ExecuteOrDelayUntilScriptLoaded(function(){var e=SP.UI.ApplicationPages.CalendarContainerFactory.create;SP.UI.ApplicationPages.CalendarContainerFactory.create=function(t,r,n,a,s){if(r.dataSources&&r.dataSources instanceof Array&&r.dataSources.length>0)for(var i=0;i<r.dataSources.length;i++)r.dataSources[i].disableDrag=!0;e(t,r,n,a,s)}},"SP.UI.ApplicationPages.Calendar.js")}}}()}(this);